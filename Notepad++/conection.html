Public Sub lsAtualizardados()
    Dim i                  As Long
    Dim lUltimalinhativa   As Long
    
    lUltimalinhativa = Worksheets("RAI").Cells(Worksheets("RAI").Rows.Count, 2).End(xlUp).Row
    'Debug.Print lUltimalinhativa
    
    For i = 2 To lUltimalinhativa
    'Debug.Print i
        Select Case Cells(i, 9).Value
        'Debug.Print Cells(i, 8)
            Case "Inserir"
                lsInserir Cells(i, 2), Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6), Cells(i, 7), Cells(i, 8)
            Case "Alterar"
                lsAlterar Cells(i, 1), Cells(i, 2), Cells(i, 3), Cells(i, 4), Cells(i, 5), Cells(i, 6), Cells(i, 7), Cells(i, 8)
            Case "Excluir"
                lsExcluir Cells(i, 1)
                
                
        End Select
    Next i
    
    lsListarDados
End Sub
























Dim gConexao As ADODB.Connection

Private Sub lsConectar()
    Dim strconexao As String
    Set gConexao = New ADODB.Connection
    
    strconexao = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=W:\DIN\GD\02_COMPARTILHADO\CTRL\IMZ\Database_RAI.accdb;Persist Security Info=False;"

    gConexao.Open strconexao
End Sub

Private Sub lsDesconectar()
    If Not gConexao Is Nothing Then
        gConexao.Close
        Set gConexao = Nothing
     End If
     
End Sub

Public Sub lsListarDados() '<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
    Dim lrs As ADODB.Recordset
    Set lrs = New ADODB.Recordset
    
    lsConectar
    lrs.Open "SELECT * FROM RAI", gConexao
    
    Sheets("RAI").Range("A2:I1048576").ClearContents
    
    Sheets("RAI").Cells(2, 1).CopyFromRecordset lrs
    
    If Not lrs Is Nothing Then
        lrs.Close
        Set lrs = Nothing
    End If
    
    lsDesconectar
    
End Sub

Public Sub lsInserir(ByVal rai As String, ByVal disciplina As String, ByVal dt_criacao As String, _
                     ByVal batch As String, ByVal sbr As String, ByVal nome As String, ByVal date_take As String)
    Dim lSQL As String
    
    date_take = Date
    
    lsConectar
    lSQL = "INSERT INTO RAI (RAI,DISCIPLINA,DT_CRIACAO,BATCH,SBR,NOME,DATE_TAKE)" & _
            "VALUES ('" & rai & "','" & disciplina & "','" & dt_criacao & "','" & batch & "','" & _
            sbr & "','" & nome & "','" & date_take & "');"
    
    gConexao.Execute lSQL
            
    lsDesconectar
    
End Sub

Public Sub lsAlterar(ByVal rai_id, ByVal rai As String, ByVal disciplina As String, ByVal dt_criacao As String, _
                     ByVal batch As String, ByVal sbr As String, ByVal nome As String, ByVal date_take As String)

                     
    Dim lSQL As String
    
    date_take = Date

    If rai_id > 0 Then
        
        lsConectar
        
        lSQL = "update RAI set RAI = '" & rai & "', DISCIPLINA = '" & disciplina & "'," & _
        "DT_CRIACAO = '" & dt_criacao & "', BATCH = '" & batch & "', SBR = '" & _
        sbr & "', NOME = '" & nome & "', DATE_TAKE = '" & date_take & "' WHERE RAI_ID = " & rai_id & ";"
        
        Debug.Print id, rai, disciplina, dt_criacao, batch, sbr, nome, date_take
        
        gConexao.Execute lSQL
        
        lsDesconectar
        
     End If
     
End Sub

Public Sub lsExcluir(ByVal rai_id)
    
    Dim lSQL As String
    
    If rai_id > 0 Then
        lsConectar
        
        Debug.Print id
        
        lSQL = "DELETE FROM RAI WHERE RAI_ID = " & rai_id
        gConexao.Execute lSQL
        
        lsDesconectar
     End If
        
        
End Sub






	// variável que usa a canvas do HTML pra mostrar o circuo na tela
	let animation_cicle = document.querySelector("canvas").getContext("2d");
    //variável que vai controlar o movimento do circulo
	let animation;

	//aqui criei uma esécide de objeto circulo e dei características pra ele
    let cicle = {
        //caracteristica de movimentação
		x: 100, // Etapa 1
        speed_x: 3, //Etapa 3
        radius: 50, //Etapa 2
        color: '#1d1413',

        //caracteristicas do circuo
		draw: function() {
            animation_cicle.beginPath();
            animation_cicle.arc(this.x, 100, this.radius, 0, 10);
            animation_cicle.fillStyle = this.color;
            animation_cicle.closePath();
            animation_cicle.fill();
        }
    };
	
	//função draw pedido no exercício
    function draw() { //Etapa 2
        
		//limpa a tela a cada moviento do circulo
        animation_cicle.clearRect(0,0, canvas.width, canvas.height);
        cicle.draw();
		//incrementa os 3 px na função
        cicle.x += cicle.speed_x;
        animation = window.requestAnimationFrame(draw);

    }

	//chama o "objeto" circulo
    cicle.draw();


	
	
	file:///W:/DIN/GD/INT/02_INTERNO/HOME_PAGE/IMZ_HOME/template.html











